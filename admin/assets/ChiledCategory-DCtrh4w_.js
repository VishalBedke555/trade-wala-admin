import{a as y,r as t,c as S,j as e,M as A,N as L,w as P,u as T,b as I,L as R,O as E,H as F}from"./index-GDIqWgRK.js";import{R as q}from"./react-paginate-DdB8dUHD.js";/* empty css               */import{D as U}from"./Drawer-BQdu0KjK.js";import{M as w}from"./Modal-BVs0t9z7.js";/* empty css                 */import"./package-BBZZd5X7.js";const _=({categoryData:n,subCategoryId:h,onClose:f})=>{const d=y(),[i,u]=t.useState({image:"",name:"",subCategoryId:h});t.useEffect(()=>{u({image:(n==null?void 0:n.image)||"",name:(n==null?void 0:n.name)||"",subCategoryId:(n==null?void 0:n.subCategoryId)||h||""})},[n,h]);const{isLoading:b,error:C}=S(l=>l.category),p=l=>{const{name:o,value:a}=l.target;u(c=>({...c,[o]:a}))},j=async l=>{const o=l.target.files[0];if(!o)return;const a=new FormData;a.append("type","category"),a.append("file",o);const c=await d(P(a));c.meta.requestStatus==="fulfilled"&&c.payload&&u(g=>({...g,image:c.payload}))},x=async l=>{l.preventDefault(),i.image!==""&&i.name!==""?(n!=null&&n._id?await d(A({childCategoryId:n._id,...i})):await d(L(i)),f()):alert("All fields are required")};return e.jsxs("div",{className:"update-category-container",children:[e.jsx("h2",{children:n!=null&&n._id?"Update Category":"Add Category"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category Name:"}),e.jsx("input",{type:"text",name:"name",value:i.name,onChange:p,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category Image:"}),i.image&&e.jsx("div",{className:"image-preview",children:e.jsx("img",{src:i.image,alt:"Category"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:j})]}),e.jsx("button",{className:"button-add",type:"submit",children:n!=null&&n._id?"Update":"Add"})]})]})},G=()=>{var v,N;T();const n=y(),h=I(),d=new URLSearchParams(h.search).get("subCategoryId"),i=t.useRef(""),[u,b]=t.useState(10),[C,p]=t.useState(1),[j,x]=t.useState(null),[l,o]=t.useState(null),a=()=>{n(E({currentPage:C,limit:u,subCategoryId:d,search:i.current.value}))};t.useEffect(()=>{a()},[n,C,u]),t.useEffect(()=>{p(1)},[h.pathname]);const c=s=>{window.confirm("Are you sure you want to delete this Child Category?")&&n(F({categoryType:"childCategory",docId:s}))},{error:g,isLoading:k,data:r}=S(s=>s.category);return e.jsxs(U,{children:[e.jsxs("div",{className:"listMain",children:[e.jsx("h2",{children:"Child Categories"}),e.jsxs("div",{className:"searchTab",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Limits "}),e.jsxs("select",{onChange:s=>{p(1),b(Number(s.target.value))},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{children:" Entries"})]}),e.jsxs("div",{className:"search-tab-flex",children:[e.jsx("button",{onClick:()=>x({subCategoryId:d}),children:"Add Category"}),e.jsx("input",{type:"text",ref:i,placeholder:"Search",onKeyDown:s=>{s.key==="Enter"&&a()}}),e.jsx("button",{onClick:()=>a(),className:"bi bi-search"})]})]}),k&&e.jsx(R,{}),r&&e.jsx("div",{style:{overflowX:"scroll"},children:e.jsxs("table",{className:"questionsTable",frame:"void",rules:"none",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sr.No."}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Count"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:((v=r==null?void 0:r.childCategories)==null?void 0:v.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center"},children:"No Records Found..."})}):(N=r==null?void 0:r.childCategories)==null?void 0:N.map((s,m)=>e.jsxs("tr",{children:[e.jsx("td",{children:m+1}),e.jsx("td",{children:e.jsx("img",{src:s==null?void 0:s.image,alt:s==null?void 0:s.name,style:{width:"50px",height:"50px",objectFit:"cover",boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px"},onClick:()=>o(s==null?void 0:s.image)})}),e.jsx("td",{children:(s==null?void 0:s.name)||"N/A"}),e.jsx("td",{children:(s==null?void 0:s.count)||0}),e.jsxs("td",{children:[new Date(s==null?void 0:s.createdAt).toLocaleString()||"N/A"," ",e.jsx("br",{})," ",e.jsx("br",{})]}),e.jsxs("td",{children:[e.jsx("button",{className:"actionButton",onClick:()=>x(s),children:e.jsx("span",{className:"bi bi-pencil"})}),e.jsx("button",{className:"actionButton",style:{backgroundColor:"var(--danger)"},onClick:()=>c(s._id),children:e.jsx("span",{className:"bi bi-trash"})})]})]},m))})]})}),g&&e.jsx("div",{className:"errDiv",children:e.jsx("p",{children:g})}),j&&e.jsx(w,{isOpen:!0,onClose:()=>x(null),children:e.jsx(_,{categoryData:j===!0?null:j,subCategoryId:d,onClose:()=>x(null)})}),l&&e.jsx(w,{isOpen:!0,onClose:()=>o(null),children:e.jsx("div",{style:{textAlign:"center"},children:e.jsx("img",{src:l,width:300,height:300,style:{objectFit:"contain"}})})})]}),e.jsx(q,{breakLabel:"...",forcePage:C-1,activePage:3,className:"pagination margin-16",nextLabel:"Next",activeClassName:"active",nextClassName:"active",previousLinkClassName:"unactive",breakClassName:"unactive",onPageChange:s=>{const m=s.selected+1;p(m)},pageRangeDisplayed:3,pageCount:(r==null?void 0:r.page)||0,previousLabel:"Previous"})]})};export{G as default};
