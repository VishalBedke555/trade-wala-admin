import{a as L,c as E,r as n,k as _,j as e,L as w,m as $,n as F,u as B,b as W,o as q,p as A}from"./index-GDIqWgRK.js";import{D as H}from"./Drawer-BQdu0KjK.js";import{d as P}from"./building1-DVpLLq6B.js";import{R as U}from"./react-paginate-DdB8dUHD.js";import{M as D}from"./Modal-BVs0t9z7.js";import"./package-BBZZd5X7.js";const V=({isOpen:t,onClose:x})=>{const c=L(),{data:o,isLoading:b,error:j}=E(a=>a.ranges),[g,d]=n.useState(""),[l,v]=n.useState("");n.useEffect(()=>{c(_())},[c]);const p=()=>{if(g.trim()===""||l.trim()==="")return;const a={startRange:Number(g),endRange:Number(l)};c($(a)),d(""),v("")},m=a=>{const[i,h]=a.split("-");console.log(i,h);const N={startRange:Number(i),endRange:Number(h)};c(F(N))};return e.jsxs(D,{isOpen:t,onClose:x,children:[e.jsxs("div",{className:"range-container",children:[e.jsx("h2",{children:"Add Kilometer Range"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"number",value:g,onChange:a=>d(a.target.value),placeholder:"Start Range",onWheel:a=>a.target.blur()}),e.jsx("input",{type:"number",value:l,onChange:a=>v(a.target.value),placeholder:"End Range",onWheel:a=>a.target.blur()}),e.jsx("button",{onClick:p,children:"Add"})]}),e.jsx("div",{className:"range-list",children:o==null?void 0:o.map((a,i)=>e.jsxs("div",{className:"range-item",children:[e.jsxs("p",{children:[a," km"]}),e.jsx("button",{className:"delete-btn",onClick:()=>m(a),children:"âœ–"})]},i))})]}),b&&e.jsx(w,{}),j&&e.jsx("div",{className:"errDiv",children:e.jsx("p",{children:j})})]})},Z=({approvalStatus:t,isFromDealer:x})=>{const c=B(),o=L(),b=W(),[j,g]=n.useState(10),[d,l]=n.useState(1),[v,p]=n.useState(!1),[m,a]=n.useState(""),[i,h]=n.useState([]),[N,C]=n.useState(!1),f=n.useRef(""),R=()=>{o(q({currentPage:d,limit:j,approvalStatus:t,search:f.current.value}))};n.useEffect(()=>{R()},[o,d,j,c]),n.useEffect(()=>{l(1)},[b.pathname]);const{error:k,isLoading:I,data:u,pageCount:y}=E(s=>s.approvals),T=s=>{p(s),h([])},K=()=>{if(!m.trim()){alert("Please provide a reason for rejection.");return}const s={dealerId:v._id,approved:!1,reason:m,rejectedFields:i};o(A(s)),p(!1),a(""),h([])},M=s=>{const r={dealerId:s._id,approved:!0,reason:""};window.confirm("Are you sure you want to accept this approval?")&&o(A(r))},O=s=>{h(r=>r.includes(s)?r.filter(S=>S!==s):[...r,s])};return e.jsxs(H,{children:[e.jsxs("div",{className:"listMain",children:[e.jsxs("h2",{children:[x?"All":t.charAt(0).toUpperCase()+t.slice(1)," Approvals"]}),e.jsxs("div",{className:"searchTab",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Limits "}),e.jsxs("select",{onChange:s=>{l(1),g(Number(s.target.value))},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{children:" Entries"})]}),e.jsxs("div",{className:"search-tab-flex",children:[e.jsx("button",{onClick:()=>C(!0),children:"Kilometer Range"}),e.jsx("input",{type:"text",ref:f,placeholder:"Search",onKeyDown:s=>{s.key==="Enter"&&(R(),l(1))}}),e.jsx("button",{onClick:()=>{R(),l(1)},className:"bi bi-search"})]})]}),I&&e.jsx(w,{}),e.jsx("div",{className:"approvals-container",children:(u==null?void 0:u.length)===0?e.jsx("p",{className:"no-records",children:"No Records Found..."}):u==null?void 0:u.map(s=>e.jsxs("div",{className:"approval-card",style:{cursor:"pointer"},onClick:()=>c(`/dealerSupplieProducts?dealerId=${s==null?void 0:s._id}&approvalStatus=${String(x)}`),children:[e.jsx("div",{className:"card-header",children:e.jsx("img",{src:(s==null?void 0:s.companyImage)||P,alt:"Company",className:"company-img",onError:r=>r.target.src=P})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h3",{className:"company-name",children:(s==null?void 0:s.companyName)||"N/A"}),e.jsxs("p",{className:"owner-name",children:["Owner: ",(s==null?void 0:s.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",(s==null?void 0:s.email)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Mobile:"})," ",(s==null?void 0:s.mobile)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Created:"})," ",new Date(s==null?void 0:s.createdAt).toLocaleString()]}),e.jsx("div",{style:{display:"flex",justifyContent:"space-between"},children:e.jsx("p",{className:"view-details",style:{color:"#3498db",padding:"0px"},onClick:()=>c(`/dealerSupplieProducts?dealerId=${s==null?void 0:s._id}&approvalStatus=${String(x)}`),children:e.jsx("u",{children:"View Details"})})}),t==="rejected"?e.jsxs("p",{className:"rejected-reason",children:[e.jsx("strong",{children:"Reason:"})," ",s==null?void 0:s.reason]}):e.jsxs("div",{className:"card-actions",children:[e.jsxs("button",{className:"reject-btn",onClick:()=>T(s),children:[e.jsx("i",{className:"bi bi-x-circle"})," Reject"]}),t!=="approved"&&e.jsxs("button",{className:"approve-btn",onClick:()=>M(s),children:[e.jsx("i",{className:"bi bi-check-circle"})," Approve"]})]})]})]},s._id))}),N&&e.jsx(V,{isOpen:N,onClose:()=>C(null)}),k&&e.jsx("div",{className:"errDiv",children:e.jsx("p",{children:k})})]}),e.jsx(U,{breakLabel:"...",forcePage:d-1,activePage:3,className:`pagination margin-16 ${y<=1?"disabled":""}`,nextLabel:"Next",activeClassName:"active",nextClassName:"active",previousLinkClassName:"unactive",breakClassName:"unactive",onPageChange:y>1?s=>{const r=s.selected+1;l(r)}:null,pageRangeDisplayed:3,pageCount:y||0,previousLabel:"Previous",disabledClassName:"disabled"}),e.jsx(D,{isOpen:v,onClose:()=>p(null),children:e.jsxs("div",{className:"reject-modal",children:[e.jsx("h2",{style:{color:"var(--text-secondery)"},children:"Provide Reason for Rejection"}),e.jsx("h3",{children:"Select Fields to Reject"}),e.jsx("div",{className:"fields-checkbox-group",children:e.jsx("ul",{style:{lineHeight:"32px",listStyle:"none",paddingLeft:"0px"},children:["companyName","email","mobile","aboutCompany","location","companyImage","companyLicence"].map(s=>e.jsx("li",{children:e.jsxs("label",{className:"field-checkbox",children:[e.jsx("input",{type:"checkbox",value:s,checked:i.includes(s),onChange:()=>O(s),style:{marginRight:"10px"}}),s]})},s))})}),e.jsx("textarea",{placeholder:"Enter reason...",value:m,onChange:s=>a(s.target.value),className:"approval-textarea"}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"actionButton",style:{backgroundColor:"var(--danger)"},onClick:()=>p(!1),children:"Cancel"}),e.jsx("button",{className:"actionButton",onClick:K,children:"Submit"})]})]})})]})};export{Z as default};
