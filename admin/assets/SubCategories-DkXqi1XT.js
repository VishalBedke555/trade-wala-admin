import{a as w,r as t,c as y,j as e,I as L,J as P,w as A,u as I,b as T,L as R,d as E,K as F,H as U}from"./index-GDIqWgRK.js";import{R as _}from"./react-paginate-DdB8dUHD.js";/* empty css               */import{D as q}from"./Drawer-BQdu0KjK.js";import{M as S}from"./Modal-BVs0t9z7.js";/* empty css                 */import"./package-BBZZd5X7.js";const M=({categoryData:n,categoryId:u,onClose:C})=>{const o=w(),[r,h]=t.useState({image:"",name:"",categoryId:u});t.useEffect(()=>{h({image:(n==null?void 0:n.image)||"",name:(n==null?void 0:n.name)||"",categoryId:(n==null?void 0:n.categoryId)||u||""})},[n,u]);const{isLoading:f,error:m}=y(a=>a.category),p=a=>{const{name:c,value:i}=a.target;h(d=>({...d,[c]:i}))},j=async a=>{const c=a.target.files[0];if(!c)return;const i=new FormData;i.append("type","category"),i.append("file",c);const d=await o(A(i));d.meta.requestStatus==="fulfilled"&&d.payload&&h(b=>({...b,image:d.payload}))},x=async a=>{a.preventDefault(),r.image!==""&&r.name!==""?(n!=null&&n._id?await o(L({subCategoryId:n._id,...r})):await o(P(r)),C()):alert("All fields are required")};return e.jsxs("div",{className:"update-category-container",children:[e.jsx("h2",{children:n!=null&&n._id?"Update Category":"Add Category"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category Name:"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:p,required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Category Image:"}),r.image&&e.jsx("div",{className:"image-preview",children:e.jsx("img",{src:r.image,alt:"Category"})}),e.jsx("input",{type:"file",accept:"image/*",onChange:j})]}),e.jsx("button",{className:"button-add",type:"submit",children:n!=null&&n._id?"Update":"Add"})]})]})},z=()=>{var v,N;I();const n=w(),u=T(),o=new URLSearchParams(u.search).get("categoryId"),r=t.useRef(""),[h,f]=t.useState(10),[m,p]=t.useState(1),[j,x]=t.useState(null),[a,c]=t.useState(null),i=()=>{n(F({currentPage:m,limit:h,categoryId:o,search:r.current.value}))};t.useEffect(()=>{i()},[n,m,h]),t.useEffect(()=>{p(1)},[u.pathname]);const d=s=>{window.confirm("Are you sure you want to delete this Sub Category?")&&n(U({categoryType:"subCategory",docId:s}))},{error:b,isLoading:k,data:l}=y(s=>s.category);return e.jsxs(q,{children:[e.jsxs("div",{className:"listMain",children:[e.jsx("h2",{children:"Sub Categories"}),e.jsxs("div",{className:"searchTab",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Limits "}),e.jsxs("select",{onChange:s=>{p(1),f(Number(s.target.value))},children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]}),e.jsx("span",{children:" Entries"})]}),e.jsxs("div",{className:"search-tab-flex",children:[e.jsx("button",{onClick:()=>x({categoryId:o}),children:"Add Category"}),e.jsx("input",{type:"text",ref:r,placeholder:"Search",onKeyDown:s=>{s.key==="Enter"&&i()}}),e.jsx("button",{onClick:()=>i(),className:"bi bi-search"})]})]}),k&&e.jsx(R,{}),l&&e.jsx("div",{style:{overflowX:"scroll"},children:e.jsxs("table",{className:"questionsTable",frame:"void",rules:"none",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sr.No."}),e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Count"}),e.jsx("th",{children:"Created At"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:((v=l==null?void 0:l.subCategories)==null?void 0:v.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,style:{textAlign:"center"},children:"No Records Found..."})}):(N=l==null?void 0:l.subCategories)==null?void 0:N.map((s,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:g+1}),e.jsx("td",{children:e.jsx("img",{src:s==null?void 0:s.image,alt:s==null?void 0:s.name,style:{width:"50px",height:"50px",objectFit:"cover",boxShadow:"rgba(0, 0, 0, 0.24) 0px 3px 8px"},onClick:()=>c(s==null?void 0:s.image)})}),e.jsx("td",{children:e.jsx(E,{to:`/chiledCategory?subCategoryId=${s==null?void 0:s._id}`,children:(s==null?void 0:s.name)||"N/A"})}),e.jsx("td",{children:(s==null?void 0:s.count)||0}),e.jsxs("td",{children:[new Date(s==null?void 0:s.createdAt).toLocaleString()||"N/A"," ",e.jsx("br",{})," ",e.jsx("br",{})]}),e.jsxs("td",{children:[e.jsx("button",{className:"actionButton",onClick:()=>x(s),children:e.jsx("span",{className:"bi bi-pencil"})}),e.jsx("button",{className:"actionButton",style:{backgroundColor:"var(--danger)"},onClick:()=>d(s._id),children:e.jsx("span",{className:"bi bi-trash"})})]})]},g))})]})}),b&&e.jsx("div",{className:"errDiv",children:e.jsx("p",{children:b})}),j&&e.jsx(S,{isOpen:!0,onClose:()=>x(null),children:e.jsx(M,{categoryData:j===!0?null:j,categoryId:o,onClose:()=>x(null)})}),a&&e.jsx(S,{isOpen:!0,onClose:()=>c(null),children:e.jsx("div",{style:{textAlign:"center"},children:e.jsx("img",{src:a,width:300,height:300,style:{objectFit:"contain"}})})})]}),e.jsx(_,{breakLabel:"...",forcePage:m-1,activePage:3,className:"pagination margin-16",nextLabel:"Next",activeClassName:"active",nextClassName:"active",previousLinkClassName:"unactive",breakClassName:"unactive",onPageChange:s=>{const g=s.selected+1;p(g)},pageRangeDisplayed:3,pageCount:(l==null?void 0:l.page)||0,previousLabel:"Previous"})]})};export{z as default};
